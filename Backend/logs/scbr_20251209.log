2025-12-09 00:27:37 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:27:37 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:27:37 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:27:37 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:27:37 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:27:37 - s_cbr.FourLayerPipeline - INFO - [L2] Agentic æ¨¡å¼æœªå•Ÿç”¨ï¼Œä½¿ç”¨å‚³çµ± L2 æ¨¡å¼
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:27:37 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:27:38 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:27:38 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:27:38 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:27:38 - s_cbr.backend.main - INFO - 
2025-12-09 00:27:38 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:27:38 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:27:38 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:27:40 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:27:40 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:27:40 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:27:40 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:28:15 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 00:28:15 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:28:15 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 00:28:15 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-002815-75b617d7]
2025-12-09 00:28:15 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:28:15 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 00:28:15 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 00:28:15 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: daeb124f***
2025-12-09 00:28:15 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:28:15 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 00:28:15 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: daeb124f-b829-40a2-b1db-b50872e3b23a
2025-12-09 00:28:15 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 00:28:15 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:28:15 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨å‚³çµ±æ¨¡å¼
2025-12-09 00:28:19 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 00:28:19 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 00:28:19 - s_cbr.FourLayerPipeline - INFO - [L1 KEYWORD PLAN]
{
  "symptom_terms": [
    "èƒƒä¸èˆ’æœ",
    "è„¹è„¹çš„",
    "æŒ‰ä¸‹å»æ›´ç—›",
    "å™å¿ƒæƒ³å",
    "å¤§ä¾¿æ¯”è¼ƒç¨€"
  ],
  "tongue_pulse_terms": [],
  "zangfu_terms": [
    "èƒƒ"
  ],
  "other_terms": [
    "è„¹ç—›",
    "å™å¿ƒ"
  ],
  "search_strategy": "exact"
}
2025-12-09 00:28:19 - s_cbr.FourLayerPipeline - INFO - [L1 BEFORE FILTER]
{
  "layer": "L1_GATE",
  "status": "ok",
  "input": {
    "user_query": "é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚",
    "history_summary": ""
  },
  "task_recognition": {
    "is_tcm_task": true,
    "tcm_task_type": "diagnosis",
    "reason": "ç”¨æˆ¶æè¿°äº†æ˜é¡¯çš„èƒƒéƒ¨ä¸é©ç—‡ç‹€ï¼ŒåŒ…æ‹¬è„¹ç—›ã€å™å¿ƒå’Œå¤§ä¾¿ç•°å¸¸ï¼Œèˆ‡ä¸­é†«è¨ºæ–·ç›¸é—œã€‚"
  },
  "owasp_screening": {
    "prompt_injection_detected": false,
    "sensitive_info_request": false,
    "system_prompt_leak_attempt": false,
    "excessive_agency_attempt": false,
    "unbounded_consumption_risk": "low",
    "flags": []
  },
  "keyword_plan": {
    "symptom_terms": [
      "èƒƒä¸èˆ’æœ",
      "è„¹è„¹çš„",
      "æŒ‰ä¸‹å»æ›´ç—›",
      "å™å¿ƒæƒ³å",
      "å¤§ä¾¿æ¯”è¼ƒç¨€"
    ],
    "tongue_pulse_terms": [],
    "zangfu_terms": [
      "èƒƒ"
    ],
    "other_terms": [
      "è„¹ç—›",
      "å™å¿ƒ"
    ],
    "search_strategy": "exact"
  },
  "next_action": "vector_search",
  "message_to_user": "å·²æ”¶åˆ°æ‚¨çš„ç—‡ç‹€æè¿°ï¼Œç³»çµ±å°‡é€²è¡Œä¸­é†«è­‰å‹åˆ†æã€‚"
}
2025-12-09 00:28:19 - s_cbr.FourLayerPipeline - INFO - [L1 AFTER  FILTER]
{
  "layer": "L1_GATE",
  "status": "ok",
  "input": {
    "user_query": "é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚",
    "history_summary": ""
  },
  "task_recognition": {
    "is_tcm_task": true,
    "tcm_task_type": "diagnosis",
    "reason": "ç”¨æˆ¶æè¿°äº†æ˜é¡¯çš„èƒƒéƒ¨ä¸é©ç—‡ç‹€ï¼ŒåŒ…æ‹¬è„¹ç—›ã€å™å¿ƒå’Œå¤§ä¾¿ç•°å¸¸ï¼Œèˆ‡ä¸­é†«è¨ºæ–·ç›¸é—œã€‚"
  },
  "owasp_screening": {
    "prompt_injection_detected": false,
    "sensitive_info_request": false,
    "[ç³»çµ±è³‡è¨Šå·²éš±è—]_leak_attempt": false,
    "excessive_agency_attempt": false,
    "unbounded_consumption_risk": "low",
    "flags": []
  },
  "keyword_plan": {
    "symptom_terms": [
      "èƒƒä¸èˆ’æœ",
      "è„¹è„¹çš„",
      "æŒ‰ä¸‹å»æ›´ç—›",
      "å™å¿ƒæƒ³å",
      "å¤§ä¾¿æ¯”è¼ƒç¨€"
    ],
    "tongue_pulse_terms": [],
    "zangfu_terms": [
      "èƒƒ"
    ],
    "other_terms": [
      "è„¹ç—›",
      "å™å¿ƒ"
    ],
    "search_strategy": "exact"
  },
  "next_action": "vector_search",
  "message_to_user": "å·²æ”¶åˆ°æ‚¨çš„ç—‡ç‹€æè¿°ï¼Œç³»çµ±å°‡é€²è¡Œä¸­é†«è­‰å‹åˆ†æã€‚"
}
2025-12-09 00:28:19 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨å‚³çµ±æª¢ç´¢æ¨¡å¼
2025-12-09 00:28:21 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.55, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 00:28:21 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.55, qdim=1024, fields=['full_text'], props=['tongue_terms', 'syndrome_terms', 'zangfu_terms', 'updated_at', 'patient_id', 'diagnosis', 'jieba_tokens', 'gender', 'full_text', 'case_id', 'visit_date', 'treatment_terms', 'suggestion', 'pulse_terms', 'age', 'treatment_principle', 'symptom_terms', 'chief_complaint', 'created_at', 'raw_data']
2025-12-09 00:28:21 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 00:28:21 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.5500'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5412'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5301'}]
2025-12-09 00:28:30 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨å‚³çµ±æ¨¡å¼ï¼ˆç„¡å·¥å…·å¢å¼·ï¼‰
2025-12-09 00:28:30 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: è„¾è™›è­‰ï¼ˆåˆæ­¥å‚¾å‘ï¼‰, è¦†è“‹åº¦: 0.60
2025-12-09 00:28:46 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 00:28:54 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± daeb124f***
2025-12-09 00:28:54 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-002815-75b617d7] è€—æ™‚: 39.14s
2025-12-09 00:28:54 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 00:28:54 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 39.14s
2025-12-09 00:29:28 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:29:28 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:29:28 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:29:28 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:29:28 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:29:28 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:29:28 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 00:29:28 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:29:28 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:29:29 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:29:29 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:29:29 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:29:29 - s_cbr.backend.main - INFO - 
2025-12-09 00:29:29 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:29:29 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:29:29 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:29:30 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:29:31 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:29:31 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:29:31 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:35:22 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 00:35:22 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:35:22 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 00:35:22 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-003522-e6ab8a3e]
2025-12-09 00:35:22 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:35:22 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 00:35:22 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 00:35:22 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: bbf1f778***
2025-12-09 00:35:22 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:35:22 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 00:35:22 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: bbf1f778-a168-4760-bc45-da0b1872fe28
2025-12-09 00:35:22 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 00:35:22 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:35:22 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 00:35:31 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 00:35:31 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 00:35:31 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.800
  Decided Alpha: 0.6
  Strategy Type: balanced
  Expected Quality: high
2025-12-09 00:35:31 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 00:35:31 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.6, ç­–ç•¥: balanced, é æœŸå“è³ª: high
2025-12-09 00:35:31 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.60
2025-12-09 00:35:32 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 00:35:32 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.60, å‘é‡: æ˜¯, Limit: 3
2025-12-09 00:35:32 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.60, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 00:35:32 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.6, qdim=1024, fields=['full_text'], props=['gender', 'raw_data', 'jieba_tokens', 'syndrome_terms', 'pulse_terms', 'case_id', 'diagnosis', 'tongue_terms', 'treatment_principle', 'zangfu_terms', 'symptom_terms', 'suggestion', 'chief_complaint', 'visit_date', 'patient_id', 'age', 'created_at', 'updated_at', 'full_text', 'treatment_terms']
2025-12-09 00:35:32 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 00:35:32 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 00:35:32 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.716
2025-12-09 00:35:32 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.716)
2025-12-09 00:35:32 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.60
  æœ€çµ‚ Alpha: 0.60
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.716
  Fallback: å¦
2025-12-09 00:35:32 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.6000'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5904'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5783'}]
2025-12-09 00:35:39 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 00:35:39 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 00:35:39 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.73
2025-12-09 00:35:39 - s_cbr.SearchEngine - INFO - ğŸ” TCM å•Ÿå‹•æª¢ç´¢: Mode=BM25-only, Î±=0.70, æŸ¥è©¢å­—ä¸²é•·åº¦=8 (è„¾è™›ï¼ˆåˆæ­¥å‚¾å‘ï¼‰...)
2025-12-09 00:35:39 - s_cbr.SearchEngine - INFO - ğŸ” TCM BM25-only Î±=0.7, qdim=0, fields=['bm25_text'], props=['gbt_code', 'subcategory', 'name_zh', 'category', 'name_en', 'tcm_id', 'vector_text', 'associated_western_diseases', 'definition', 'clinical_manifestations']
2025-12-09 00:35:39 - s_cbr.SearchEngine - INFO - ğŸ“Š TCM æœç´¢: 0 å€‹çµæœ
2025-12-09 00:35:39 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool A (å°‹æ±‚ ICD-11 æ¨™æº–åŒ–èƒŒæ›¸)
2025-12-09 00:35:39 - L2AgenticDiagnosis - INFO - [L2Agentic] ä¸¦è¡ŒåŸ·è¡Œ 1 å€‹å·¥å…·èª¿ç”¨
2025-12-09 00:35:39 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89 200
2025-12-09 00:35:40 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=11&FORM=PERE 200
2025-12-09 00:35:41 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=21&FORM=PERE1 200
2025-12-09 00:35:42 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=31&FORM=PERE2 200
2025-12-09 00:35:43 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=41&FORM=PERE3 200
2025-12-09 00:35:43 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.15
2025-12-09 00:35:43 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.15
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.73
2025-12-09 00:35:43 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: è„¾è™›ï¼ˆåˆæ­¥å‚¾å‘ï¼‰, è¦†è“‹åº¦: 0.60
2025-12-09 00:35:55 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 00:36:03 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± bbf1f778***
2025-12-09 00:36:03 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-003522-e6ab8a3e] è€—æ™‚: 40.66s
2025-12-09 00:36:03 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 00:36:03 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 40.66s
2025-12-09 00:48:19 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:48:19 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:48:19 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:48:19 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:48:19 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:48:19 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:48:19 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 00:48:19 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:48:19 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:48:20 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:48:20 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:48:20 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:48:20 - s_cbr.backend.main - INFO - 
2025-12-09 00:48:20 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:48:20 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:48:20 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:48:21 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:48:21 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:48:21 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:48:21 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:49:06 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:49:06 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:49:06 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:49:06 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:49:06 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:49:06 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:49:06 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 00:49:06 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:49:06 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:49:06 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:49:06 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:49:06 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:49:06 - s_cbr.backend.main - INFO - 
2025-12-09 00:49:06 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:49:06 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:49:06 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:49:08 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:49:08 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:49:08 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:49:08 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:49:16 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 00:49:16 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:49:16 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 00:49:16 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-004916-d9671192]
2025-12-09 00:49:16 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:49:16 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 00:49:16 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 00:49:16 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: 2c1684bb***
2025-12-09 00:49:16 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:49:16 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 00:49:16 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: 2c1684bb-d58e-47f2-9928-cdc3e5b756fc
2025-12-09 00:49:16 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 00:49:16 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:49:16 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 00:49:25 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 00:49:25 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 00:49:25 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.650
  Decided Alpha: 0.6
  Strategy Type: balanced
  Expected Quality: medium
2025-12-09 00:49:25 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 00:49:25 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.6, ç­–ç•¥: balanced, é æœŸå“è³ª: medium
2025-12-09 00:49:25 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.60
2025-12-09 00:49:26 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 00:49:26 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.60, å‘é‡: æ˜¯, Limit: 3
2025-12-09 00:49:26 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.60, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 00:49:26 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.6, qdim=1024, fields=['full_text'], props=['suggestion', 'pulse_terms', 'treatment_terms', 'full_text', 'gender', 'case_id', 'syndrome_terms', 'treatment_principle', 'visit_date', 'age', 'raw_data', 'chief_complaint', 'zangfu_terms', 'tongue_terms', 'updated_at', 'jieba_tokens', 'patient_id', 'diagnosis', 'created_at', 'symptom_terms']
2025-12-09 00:49:26 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 00:49:26 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 00:49:26 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.716
2025-12-09 00:49:26 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.716)
2025-12-09 00:49:26 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.60
  æœ€çµ‚ Alpha: 0.60
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.716
  Fallback: å¦
2025-12-09 00:49:26 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.6000'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5904'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5783'}]
2025-12-09 00:49:33 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 00:49:33 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 00:49:33 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 00:49:33 - L2AgenticDiagnosis - WARNING - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«æŸ¥è©¢å¤±æ•—: 'L2AgenticDiagnosis' object has no attribute 'embed'
2025-12-09 00:49:33 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool C (ç½®ä¿¡åº¦ä¸è¶³: 0.68)
2025-12-09 00:49:33 - L2AgenticDiagnosis - INFO - [L2Agentic] ä¸¦è¡ŒåŸ·è¡Œ 1 å€‹å·¥å…·èª¿ç”¨
2025-12-09 00:49:33 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism 200
2025-12-09 00:49:34 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=11&FORM=PERE 200
2025-12-09 00:49:37 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=21&FORM=PERE1 200
2025-12-09 00:49:38 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=31&FORM=PERE2 200
2025-12-09 00:49:39 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=41&FORM=PERE3 200
2025-12-09 00:49:39 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.05
2025-12-09 00:49:39 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.05
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 00:49:39 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: è„¾è™›è­‰å‹ï¼ˆåˆæ­¥å‚¾å‘ï¼‰, è¦†è“‹åº¦: 0.60
2025-12-09 00:49:46 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 00:49:53 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± 2c1684bb***
2025-12-09 00:49:53 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-004916-d9671192] è€—æ™‚: 37.24s
2025-12-09 00:49:53 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 00:49:53 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 37.24s
2025-12-09 00:52:06 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:52:06 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:52:06 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:52:06 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:52:06 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:52:06 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:52:06 - s_cbr.FourLayerPipeline - WARNING - [L2Agentic] åˆå§‹åŒ–å¤±æ•—: name 'embed_client' is not definedï¼Œå°‡é™ç´šç‚ºå‚³çµ± L2 æ¨¡å¼
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:52:06 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:52:07 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:52:07 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:52:07 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:52:07 - s_cbr.backend.main - INFO - 
2025-12-09 00:52:07 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:52:07 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:52:07 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:52:08 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:52:09 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:52:09 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:52:09 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:32 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:53:32 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:53:32 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:32 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:32 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:53:32 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:53:32 - s_cbr.FourLayerPipeline - WARNING - [L2Agentic] åˆå§‹åŒ–å¤±æ•—: name 'embed_client' is not definedï¼Œå°‡é™ç´šç‚ºå‚³çµ± L2 æ¨¡å¼
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:53:32 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:53:33 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:53:33 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:53:33 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:53:33 - s_cbr.backend.main - INFO - 
2025-12-09 00:53:33 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:53:33 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:53:33 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:53:34 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:53:35 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:53:35 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:53:35 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:58 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:53:58 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:53:58 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:58 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:53:58 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:53:58 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:53:58 - s_cbr.FourLayerPipeline - WARNING - [L2Agentic] åˆå§‹åŒ–å¤±æ•—: name 'embed_client' is not definedï¼Œå°‡é™ç´šç‚ºå‚³çµ± L2 æ¨¡å¼
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:53:58 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:53:59 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:53:59 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:53:59 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:53:59 - s_cbr.backend.main - INFO - 
2025-12-09 00:53:59 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:53:59 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:53:59 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:54:00 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:54:00 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:54:00 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:54:00 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:55:30 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:55:30 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:55:30 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:55:30 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:55:30 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:55:30 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:55:30 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:55:30 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:55:31 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:55:31 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:55:31 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:55:31 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:55:31 - s_cbr.FourLayerPipeline - WARNING - [L2Agentic] åˆå§‹åŒ–å¤±æ•—: name 'embed_client' is not definedï¼Œå°‡é™ç´šç‚ºå‚³çµ± L2 æ¨¡å¼
2025-12-09 00:55:31 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:55:31 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:55:31 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:55:31 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:55:31 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:55:31 - s_cbr.backend.main - INFO - 
2025-12-09 00:55:31 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:55:31 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:55:31 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:55:33 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:55:33 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:55:33 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:55:33 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:05 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:05 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:56:05 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:05 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:05 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:56:05 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:56:05 - s_cbr.FourLayerPipeline - WARNING - [L2Agentic] åˆå§‹åŒ–å¤±æ•—: L2AgenticDiagnosis.__init__() got an unexpected keyword argument 'embed_client'ï¼Œå°‡é™ç´šç‚ºå‚³çµ± L2 æ¨¡å¼
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:05 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:56:06 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:56:06 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:56:06 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:56:06 - s_cbr.backend.main - INFO - 
2025-12-09 00:56:06 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:56:06 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:56:06 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:56:08 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:56:08 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:56:08 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:22 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:22 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:56:22 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:22 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:22 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:56:22 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:56:22 - s_cbr.FourLayerPipeline - WARNING - [L2Agentic] åˆå§‹åŒ–å¤±æ•—: L2AgenticDiagnosis.__init__() got an unexpected keyword argument 'embed_client'ï¼Œå°‡é™ç´šç‚ºå‚³çµ± L2 æ¨¡å¼
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:22 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:56:23 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:56:23 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:56:23 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:56:23 - s_cbr.backend.main - INFO - 
2025-12-09 00:56:23 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:56:23 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:56:23 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:56:24 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:56:24 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:56:24 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:56:24 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:46 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:46 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:46 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:46 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:46 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 00:56:46 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 00:56:46 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:46 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:47 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 00:56:47 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:47 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 00:56:47 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 00:56:47 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 00:56:47 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 00:56:47 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 00:56:47 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 00:56:47 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 00:56:47 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:56:47 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 00:56:47 - s_cbr.backend.main - INFO - 
2025-12-09 00:56:47 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 00:56:47 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 00:56:47 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 00:56:49 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 00:56:49 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 00:56:49 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 00:56:49 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 00:56:57 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 00:56:57 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:56:57 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 00:56:57 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-005657-e2516340]
2025-12-09 00:56:57 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:56:57 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 00:56:57 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 00:56:57 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: 05338c81***
2025-12-09 00:56:57 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:56:57 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 00:56:57 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: 05338c81-b3b9-4f2a-ad02-8e2e8d02e29c
2025-12-09 00:56:57 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 00:56:57 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 00:56:57 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 00:57:05 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 00:57:05 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 00:57:05 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.650
  Decided Alpha: 0.55
  Strategy Type: balanced
  Expected Quality: medium
2025-12-09 00:57:05 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 00:57:05 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.55, ç­–ç•¥: balanced, é æœŸå“è³ª: medium
2025-12-09 00:57:05 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.55
2025-12-09 00:57:06 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 00:57:06 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.55, å‘é‡: æ˜¯, Limit: 3
2025-12-09 00:57:06 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.55, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 00:57:06 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.55, qdim=1024, fields=['full_text'], props=['zangfu_terms', 'syndrome_terms', 'full_text', 'jieba_tokens', 'suggestion', 'diagnosis', 'updated_at', 'created_at', 'visit_date', 'treatment_principle', 'tongue_terms', 'gender', 'symptom_terms', 'raw_data', 'treatment_terms', 'case_id', 'age', 'patient_id', 'chief_complaint', 'pulse_terms']
2025-12-09 00:57:07 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 00:57:07 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 00:57:07 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.681
2025-12-09 00:57:07 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.681)
2025-12-09 00:57:07 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.55
  æœ€çµ‚ Alpha: 0.55
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.681
  Fallback: å¦
2025-12-09 00:57:07 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.5500'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5412'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5301'}]
2025-12-09 00:57:13 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 00:57:13 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 00:57:13 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 00:57:15 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«æŸ¥è©¢: 'é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...' (Alpha=0.9, Vector=Yes)
2025-12-09 00:57:15 - s_cbr.SearchEngine - INFO - ğŸ” TCM å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.90, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 00:57:15 - s_cbr.SearchEngine - INFO - ğŸ” TCM HYBRID Î±=0.9, qdim=1024, fields=['vector_text', 'name_zh', 'clinical_manifestations'], props=['definition', 'clinical_manifestations', 'associated_western_diseases', 'subcategory', 'name_en', 'gbt_code', 'category', 'name_zh', 'tcm_id', 'vector_text']
2025-12-09 00:57:15 - s_cbr.SearchEngine - INFO - ğŸ“Š TCM æœç´¢: 1 å€‹çµæœ
2025-12-09 00:57:15 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«å‘½ä¸­: æ¿•ç†±è…°ç—›è­‰ (Score: 0.900)
2025-12-09 00:57:15 - L2AgenticDiagnosis - INFO - [L2Agentic] å·²æ³¨å…¥å…§éƒ¨çŸ¥è­˜: æ¿•ç†±è…°ç—›è­‰
2025-12-09 00:57:15 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«å·²æ»¿è¶³çŸ¥è­˜ç¼ºå£ï¼Œè·³é Tool B
2025-12-09 00:57:15 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool C (ç½®ä¿¡åº¦ä¸è¶³: 0.68)
2025-12-09 00:57:15 - L2AgenticDiagnosis - INFO - [L2Agentic] ä¸¦è¡ŒåŸ·è¡Œ 1 å€‹å·¥å…·èª¿ç”¨
2025-12-09 00:57:15 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism 200
2025-12-09 00:57:16 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=11&FORM=PERE 200
2025-12-09 00:57:17 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=21&FORM=PERE1 200
2025-12-09 00:57:18 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=31&FORM=PERE2 200
2025-12-09 00:57:19 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=41&FORM=PERE3 200
2025-12-09 00:57:19 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.15
2025-12-09 00:57:19 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.15
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 00:57:19 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: è„¾è™›è­‰å‹ï¼ˆåˆæ­¥å‚¾å‘ï¼‰, è¦†è“‹åº¦: 0.60
2025-12-09 00:57:25 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 00:57:32 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± 05338c81***
2025-12-09 00:57:32 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-005657-e2516340] è€—æ™‚: 35.43s
2025-12-09 00:57:32 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 00:57:32 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 35.43s
2025-12-09 01:22:16 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:22:16 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 01:22:16 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:16 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:16 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 01:22:16 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 01:22:16 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 01:22:16 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 01:22:16 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 01:22:17 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 01:22:17 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:22:17 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 01:22:17 - s_cbr.backend.main - INFO - 
2025-12-09 01:22:17 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 01:22:17 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 01:22:17 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:22:18 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 01:22:19 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 01:22:19 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 01:22:19 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:44 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:22:44 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 01:22:44 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:44 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:22:44 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 01:22:44 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 01:22:44 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 01:22:44 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 01:22:44 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 01:22:45 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 01:22:45 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:22:45 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 01:22:45 - s_cbr.backend.main - INFO - 
2025-12-09 01:22:45 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 01:22:45 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 01:22:45 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:22:46 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 01:22:46 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 01:22:47 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 01:22:47 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:23:05 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 01:23:05 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:23:05 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 01:23:05 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-012305-eee78b44]
2025-12-09 01:23:05 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:23:05 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 01:23:05 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 01:23:05 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: 3b7e7634***
2025-12-09 01:23:05 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:23:05 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 01:23:05 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: 3b7e7634-ae6b-4ac3-93f4-f2f11a446f97
2025-12-09 01:23:05 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 01:23:05 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:23:05 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 01:23:14 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 01:23:14 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 01:23:14 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.650
  Decided Alpha: 0.55
  Strategy Type: balanced
  Expected Quality: medium
2025-12-09 01:23:14 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 01:23:14 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.55, ç­–ç•¥: balanced, é æœŸå“è³ª: medium
2025-12-09 01:23:14 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.55
2025-12-09 01:23:15 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 01:23:15 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.55, å‘é‡: æ˜¯, Limit: 3
2025-12-09 01:23:15 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.55, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 01:23:15 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.55, qdim=1024, fields=['full_text'], props=['full_text', 'treatment_terms', 'chief_complaint', 'visit_date', 'raw_data', 'symptom_terms', 'created_at', 'patient_id', 'tongue_terms', 'treatment_principle', 'age', 'pulse_terms', 'syndrome_terms', 'zangfu_terms', 'updated_at', 'case_id', 'diagnosis', 'gender', 'suggestion', 'jieba_tokens']
2025-12-09 01:23:15 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 01:23:15 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 01:23:15 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.681
2025-12-09 01:23:15 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.681)
2025-12-09 01:23:15 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.55
  æœ€çµ‚ Alpha: 0.55
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.681
  Fallback: å¦
2025-12-09 01:23:15 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.5500'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5412'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5301'}]
2025-12-09 01:23:22 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 01:23:22 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 01:23:22 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 01:23:24 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«æŸ¥è©¢: 'é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...' (Alpha=0.5, Vector=Yes)
2025-12-09 01:23:24 - s_cbr.SearchEngine - INFO - ğŸ” TCM å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.50, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 01:23:24 - s_cbr.SearchEngine - INFO - ğŸ” TCM HYBRID Î±=0.5, qdim=1024, fields=['vector_text', 'name_zh^2', 'clinical_manifestations'], props=['vector_text', 'clinical_manifestations', 'name_en', 'associated_western_diseases', 'subcategory', 'definition', 'category', 'gbt_code', 'name_zh', 'tcm_id']
2025-12-09 01:23:24 - s_cbr.SearchEngine - INFO - ğŸ“Š TCM æœç´¢: 3 å€‹çµæœ
2025-12-09 01:23:24 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«ç„¡åŒ¹é… (Top: æ¿•ç†±è…°ç—›è­‰, Score: 0.500 - å·²è¢«éæ¿¾æˆ–åˆ†æ•¸ä¸è¶³)
2025-12-09 01:23:24 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool B (ç—…æ©Ÿç¼ºå¤±ä¸”ç„¡å…§éƒ¨åº«å­˜: 0.50)
2025-12-09 01:23:24 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool C (ç½®ä¿¡åº¦ä¸è¶³: 0.68)
2025-12-09 01:23:24 - L2AgenticDiagnosis - INFO - [L2Agentic] ä¸¦è¡ŒåŸ·è¡Œ 2 å€‹å·¥å…·èª¿ç”¨
2025-12-09 01:23:24 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism 200
2025-12-09 01:23:25 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=11&FORM=PERE 200
2025-12-09 01:23:26 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=21&FORM=PERE1 200
2025-12-09 01:23:27 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=31&FORM=PERE2 200
2025-12-09 01:23:27 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=41&FORM=PERE3 200
2025-12-09 01:23:28 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 2
  ç½®ä¿¡åº¦æå‡: +0.05
2025-12-09 01:23:28 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 2
  ç½®ä¿¡åº¦æå‡: +0.05
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 01:23:28 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: è„¾è™›è­‰å‹ï¼ˆåˆæ­¥å‚¾å‘ï¼‰, è¦†è“‹åº¦: 0.60
2025-12-09 01:23:41 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 01:23:48 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± 3b7e7634***
2025-12-09 01:23:48 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-012305-eee78b44] è€—æ™‚: 43.00s
2025-12-09 01:23:48 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 01:23:48 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 43.00s
2025-12-09 01:33:54 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:33:54 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 01:33:54 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:33:54 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:33:54 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 01:33:54 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 01:33:54 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 01:33:54 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 01:33:54 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 01:33:54 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 01:33:54 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:33:54 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 01:33:54 - s_cbr.backend.main - INFO - 
2025-12-09 01:33:54 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 01:33:54 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 01:33:54 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:33:56 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 01:33:56 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 01:33:56 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 01:33:56 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:33:57 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 01:33:57 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:33:57 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 01:33:57 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-013357-343112e5]
2025-12-09 01:33:57 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:33:57 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 01:33:57 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 01:33:57 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: 70a8ab8a***
2025-12-09 01:33:57 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:33:57 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 01:33:57 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: 70a8ab8a-1ac7-44a5-ae6e-7615c3a6e22c
2025-12-09 01:33:57 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 01:33:57 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 01:33:57 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 01:34:06 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 01:34:06 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 01:34:06 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.800
  Decided Alpha: 0.6
  Strategy Type: balanced
  Expected Quality: high
2025-12-09 01:34:06 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 01:34:06 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.6, ç­–ç•¥: balanced, é æœŸå“è³ª: high
2025-12-09 01:34:06 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.60
2025-12-09 01:34:08 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 01:34:08 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.60, å‘é‡: æ˜¯, Limit: 3
2025-12-09 01:34:08 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.60, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 01:34:08 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.6, qdim=1024, fields=['full_text'], props=['patient_id', 'suggestion', 'tongue_terms', 'created_at', 'syndrome_terms', 'symptom_terms', 'chief_complaint', 'visit_date', 'raw_data', 'zangfu_terms', 'updated_at', 'treatment_principle', 'jieba_tokens', 'gender', 'treatment_terms', 'pulse_terms', 'age', 'case_id', 'full_text', 'diagnosis']
2025-12-09 01:34:08 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 01:34:08 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 01:34:08 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.716
2025-12-09 01:34:08 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.716)
2025-12-09 01:34:08 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.60
  æœ€çµ‚ Alpha: 0.60
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.716
  Fallback: å¦
2025-12-09 01:34:08 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.6000'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5904'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5783'}]
2025-12-09 01:34:16 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 01:34:16 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 01:34:16 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.73
2025-12-09 01:34:18 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«æŸ¥è©¢: 'é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...' (Alpha=0.2, Vector=Yes)
2025-12-09 01:34:18 - s_cbr.SearchEngine - INFO - ğŸ” TCM å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.20, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 01:34:18 - s_cbr.SearchEngine - INFO - ğŸ” TCM HYBRID Î±=0.2, qdim=1024, fields=['name_zh', 'definition', 'clinical_manifestations', 'vector_text'], props=['subcategory', 'clinical_manifestations', 'vector_text', 'definition', 'category', 'associated_western_diseases', 'tcm_id', 'gbt_code', 'name_zh', 'name_en']
2025-12-09 01:34:18 - s_cbr.SearchEngine - INFO - ğŸ“Š TCM æœç´¢: 3 å€‹çµæœ
2025-12-09 01:34:18 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨æª¢ç´¢å€™é¸: ['æ¿•ç†±è…°ç—›è­‰', 'å¿ƒæ°£è™›å¼±è­‰ (æ±—è­‰)', 'è…æ°£ä¸è¶³è­‰ (éºå°¿/äº”é²)']
2025-12-09 01:34:18 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«ç„¡åŒ¹é… (Top: æ¿•ç†±è…°ç—›è­‰, Score: 0.200 - éæ¿¾æˆ–åˆ†æ•¸éä½)
2025-12-09 01:34:18 - L2AgenticDiagnosis - INFO - [L2Agentic] ç„¡éœ€èª¿ç”¨å·¥å…·ï¼Œæ¢ä»¶æœªè§¸ç™¼
2025-12-09 01:34:18 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: unvalidated
  å·¥å…·èª¿ç”¨æ•¸: 0
  ç½®ä¿¡åº¦æå‡: +0.00
2025-12-09 01:34:18 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: unvalidated
  å·¥å…·èª¿ç”¨æ•¸: 0
  ç½®ä¿¡åº¦æå‡: +0.00
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.73
2025-12-09 01:34:18 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: æ³„ç€‰ï¼ˆè„¾è™›ï¼‰(åˆæ­¥å‚¾å‘), è¦†è“‹åº¦: 0.60
2025-12-09 01:34:25 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 01:34:33 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± 70a8ab8a***
2025-12-09 01:34:33 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-013357-343112e5] è€—æ™‚: 35.82s
2025-12-09 01:34:33 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 01:34:33 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 35.83s
2025-12-09 01:50:26 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:50:26 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 01:50:26 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:50:26 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:50:26 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 01:50:26 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 01:50:26 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 01:50:26 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 01:50:26 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 01:50:27 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 01:50:27 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:50:27 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 01:50:27 - s_cbr.backend.main - INFO - 
2025-12-09 01:50:27 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 01:50:27 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 01:50:27 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:50:28 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 01:50:29 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 01:50:29 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 01:50:29 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:51:57 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:51:57 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:51:57 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:51:57 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 01:51:57 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 01:51:57 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 01:51:57 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:51:57 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:51:58 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 01:51:58 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 01:51:58 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 01:51:58 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 01:51:58 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 01:51:58 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 01:51:58 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 01:51:58 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 01:51:58 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 01:51:58 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:51:58 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 01:51:58 - s_cbr.backend.main - INFO - 
2025-12-09 01:51:58 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 01:51:58 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 01:51:58 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 01:52:00 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 01:52:00 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 01:52:00 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 01:52:00 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:08:43 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:08:43 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:08:43 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:08:43 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:08:43 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:08:43 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:08:43 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:08:43 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:08:43 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:08:44 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:08:44 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:08:44 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:08:44 - s_cbr.backend.main - INFO - 
2025-12-09 02:08:44 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:08:44 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:08:44 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:08:45 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:08:46 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:08:46 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:08:46 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:09:22 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:09:22 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:09:22 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:09:22 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:09:22 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:09:22 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:09:22 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:09:22 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:09:22 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:09:23 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:09:23 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:09:23 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:09:23 - s_cbr.backend.main - INFO - 
2025-12-09 02:09:23 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:09:23 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:09:23 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:09:24 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:09:24 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:09:24 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:09:24 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:10:24 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:10:24 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:10:24 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:10:24 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:10:24 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:10:24 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:10:24 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:10:24 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:10:24 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:10:25 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:10:25 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:10:25 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:10:25 - s_cbr.backend.main - INFO - 
2025-12-09 02:10:25 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:10:25 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:10:25 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:10:26 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:10:27 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:10:27 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:10:27 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:00 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:00 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:13:00 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:00 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:00 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:13:00 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:13:00 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:13:00 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:00 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:13:01 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:13:01 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:13:01 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:13:01 - s_cbr.backend.main - INFO - 
2025-12-09 02:13:01 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:13:01 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:13:01 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:13:02 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:13:03 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:13:03 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:13:03 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:16 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:16 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:16 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:16 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:16 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:13:16 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:13:16 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:16 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:17 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:13:17 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:17 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:13:17 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:13:17 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:13:17 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:13:17 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:17 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:13:17 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:13:17 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:13:17 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:13:17 - s_cbr.backend.main - INFO - 
2025-12-09 02:13:17 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:13:17 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:13:17 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:13:19 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:13:19 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:13:19 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:13:19 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:50 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:50 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:13:50 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:50 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:50 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:13:50 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:13:50 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:13:50 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:13:50 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:13:51 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:13:51 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:13:51 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:13:51 - s_cbr.backend.main - INFO - 
2025-12-09 02:13:51 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:13:51 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:13:51 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:13:52 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:13:53 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:13:53 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:13:53 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:13:57 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 02:13:57 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:13:57 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 02:13:57 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-021357-67645fba]
2025-12-09 02:13:57 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:13:57 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 02:13:57 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 02:13:57 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: 6d7a4602***
2025-12-09 02:13:57 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:13:57 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 02:13:57 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: 6d7a4602-1886-4d98-80de-6db476152f8c
2025-12-09 02:13:57 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 02:13:57 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:13:57 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 02:14:06 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 02:14:06 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 02:14:06 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.650
  Decided Alpha: 0.55
  Strategy Type: balanced
  Expected Quality: medium
2025-12-09 02:14:06 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 02:14:06 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.55, ç­–ç•¥: balanced, é æœŸå“è³ª: medium
2025-12-09 02:14:06 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.55
2025-12-09 02:14:08 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 02:14:08 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.55, å‘é‡: æ˜¯, Limit: 3
2025-12-09 02:14:08 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.55, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 02:14:08 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.55, qdim=1024, fields=['full_text'], props=['tongue_terms', 'treatment_terms', 'age', 'updated_at', 'visit_date', 'pulse_terms', 'full_text', 'created_at', 'chief_complaint', 'patient_id', 'diagnosis', 'symptom_terms', 'jieba_tokens', 'gender', 'syndrome_terms', 'treatment_principle', 'raw_data', 'suggestion', 'zangfu_terms', 'case_id']
2025-12-09 02:14:08 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 02:14:08 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 02:14:08 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.681
2025-12-09 02:14:08 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.681)
2025-12-09 02:14:08 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.55
  æœ€çµ‚ Alpha: 0.55
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.681
  Fallback: å¦
2025-12-09 02:14:08 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.5500'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5412'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5301'}]
2025-12-09 02:14:14 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 02:14:14 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 02:14:14 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 02:14:16 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«æŸ¥è©¢: 'æ„Ÿè¦ºè„¹è„¹çš„ æŒ‰ä¸‹å»æ›´ç—› æœ‰é»å™å¿ƒæƒ³å å¤§...' (Alpha=0.2, æ’é™¤=['èˆ’æœ'])
2025-12-09 02:14:16 - s_cbr.SearchEngine - INFO - ğŸ” TCM å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.20, æŸ¥è©¢å­—ä¸²é•·åº¦=25 (æ„Ÿè¦ºè„¹è„¹çš„ æŒ‰ä¸‹å»æ›´ç—› æœ‰é»å™å¿ƒæƒ³å å¤§...)
2025-12-09 02:14:16 - s_cbr.SearchEngine - INFO - ğŸ” TCM HYBRID Î±=0.2, qdim=1024, fields=['name_zh', 'definition', 'clinical_manifestations', 'vector_text'], props=['name_en', 'clinical_manifestations', 'associated_western_diseases', 'name_zh', 'gbt_code', 'definition', 'vector_text', 'tcm_id', 'category', 'subcategory']
2025-12-09 02:14:16 - s_cbr.SearchEngine - INFO - ğŸ“Š TCM æœç´¢: 3 å€‹çµæœ
2025-12-09 02:14:16 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨æª¢ç´¢å€™é¸: ['å–œå‚·å¿ƒ (å¿ƒç¥æ¸™æ•£)', 'å¯’å‡å¿ƒè„ˆè­‰ (å¿ƒçµç—›)', 'å¿ƒæ°£è™›è­‰']
2025-12-09 02:14:16 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«ç„¡åŒ¹é… (Top: å–œå‚·å¿ƒ (å¿ƒç¥æ¸™æ•£) - å·²è¢«éæ¿¾)
2025-12-09 02:14:16 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool B (ç—…æ©Ÿç¼ºå¤±ä¸”ç„¡å…§éƒ¨åº«å­˜: 0.50)
2025-12-09 02:14:16 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool C (ç½®ä¿¡åº¦ä¸è¶³: 0.68)
2025-12-09 02:14:16 - L2AgenticDiagnosis - INFO - [L2Agentic] ä¸¦è¡ŒåŸ·è¡Œ 2 å€‹å·¥å…·èª¿ç”¨
2025-12-09 02:14:16 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism 200
2025-12-09 02:14:17 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=11&FORM=PERE 200
2025-12-09 02:14:18 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=21&FORM=PERE1 200
2025-12-09 02:14:19 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=31&FORM=PERE2 200
2025-12-09 02:14:20 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%E5%9E%8B%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=41&FORM=PERE3 200
2025-12-09 02:14:20 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 2
  ç½®ä¿¡åº¦æå‡: +0.05
2025-12-09 02:14:20 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 2
  ç½®ä¿¡åº¦æå‡: +0.05
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 02:14:20 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: è„¾è™›è­‰å‹ï¼ˆåˆæ­¥å‚¾å‘ï¼‰, è¦†è“‹åº¦: 0.60
2025-12-09 02:14:26 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 02:14:33 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± 6d7a4602***
2025-12-09 02:14:33 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-021357-67645fba] è€—æ™‚: 35.43s
2025-12-09 02:14:33 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 02:14:33 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 35.43s
2025-12-09 02:18:40 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:18:40 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:18:40 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:18:40 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:18:40 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:18:40 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:18:40 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:18:40 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:18:40 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:18:41 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:18:41 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:18:41 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:18:41 - s_cbr.backend.main - INFO - 
2025-12-09 02:18:41 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:18:41 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:18:41 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:18:42 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:18:42 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:18:42 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:18:42 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:19:29 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:19:29 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:19:29 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:19:29 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:19:29 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:19:29 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:19:29 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:19:29 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:19:29 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:19:30 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:19:30 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:19:30 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:19:30 - s_cbr.backend.main - INFO - 
2025-12-09 02:19:30 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:19:30 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:19:30 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:19:31 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:19:31 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:19:32 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:19:32 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:19:36 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 02:19:36 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:19:36 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 02:19:36 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-021936-c128afc5]
2025-12-09 02:19:36 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:19:36 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 02:19:36 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 02:19:36 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: 1a6c47c8***
2025-12-09 02:19:36 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:19:36 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 02:19:36 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: 1a6c47c8-2fd8-4597-b47b-32326c2d8ad8
2025-12-09 02:19:36 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 02:19:36 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:19:36 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 02:19:45 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 02:19:45 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 02:19:45 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.650
  Decided Alpha: 0.55
  Strategy Type: balanced
  Expected Quality: medium
2025-12-09 02:19:45 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 02:19:45 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.55, ç­–ç•¥: balanced, é æœŸå“è³ª: medium
2025-12-09 02:19:45 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.55
2025-12-09 02:19:46 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 02:19:46 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.55, å‘é‡: æ˜¯, Limit: 3
2025-12-09 02:19:46 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.55, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 02:19:46 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.55, qdim=1024, fields=['full_text'], props=['treatment_principle', 'syndrome_terms', 'symptom_terms', 'chief_complaint', 'tongue_terms', 'treatment_terms', 'updated_at', 'pulse_terms', 'age', 'jieba_tokens', 'suggestion', 'created_at', 'diagnosis', 'case_id', 'patient_id', 'full_text', 'gender', 'visit_date', 'zangfu_terms', 'raw_data']
2025-12-09 02:19:46 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 02:19:46 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 02:19:46 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.681
2025-12-09 02:19:46 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.681)
2025-12-09 02:19:46 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.55
  æœ€çµ‚ Alpha: 0.55
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.681
  Fallback: å¦
2025-12-09 02:19:46 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.5500'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5412'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5301'}]
2025-12-09 02:19:53 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 02:19:53 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 02:19:53 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 02:19:55 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«æŸ¥è©¢: 'é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœ æ„Ÿè¦ºè„¹è„¹çš„ æŒ‰ä¸‹å»æ›´ç—›...' (Alpha=0.2, æ’é™¤=[])
2025-12-09 02:19:55 - s_cbr.SearchEngine - INFO - ğŸ” TCM å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.20, æŸ¥è©¢å­—ä¸²é•·åº¦=33 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœ æ„Ÿè¦ºè„¹è„¹çš„ æŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 02:19:55 - s_cbr.SearchEngine - INFO - ğŸ” TCM HYBRID Î±=0.2, qdim=1024, fields=['name_zh', 'definition', 'clinical_manifestations', 'vector_text'], props=['category', 'gbt_code', 'clinical_manifestations', 'associated_western_diseases', 'definition', 'tcm_id', 'name_zh', 'name_en', 'vector_text', 'subcategory']
2025-12-09 02:19:55 - s_cbr.SearchEngine - INFO - ğŸ“Š TCM æœç´¢: 3 å€‹çµæœ
2025-12-09 02:19:55 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨æª¢ç´¢å€™é¸: ['æ¿•ç†±è…°ç—›è­‰', 'è…æ°£ä¸è¶³è­‰ (éºå°¿/äº”é²)', 'æ¿•ç†±è…°ç—›è­‰']
2025-12-09 02:19:55 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«ç„¡åŒ¹é… (Top: æ¿•ç†±è…°ç—›è­‰ - å·²è¢«éæ¿¾)
2025-12-09 02:19:55 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool B (ç—…æ©Ÿç¼ºå¤±ä¸”ç„¡å…§éƒ¨åº«å­˜: 0.50)
2025-12-09 02:19:55 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool C (ç½®ä¿¡åº¦ä¸è¶³: 0.68)
2025-12-09 02:19:55 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool A (å°‹æ±‚ ICD-11 æ¨™æº–åŒ–èƒŒæ›¸)
2025-12-09 02:19:55 - L2AgenticDiagnosis - INFO - [L2Agentic] ä¸¦è¡ŒåŸ·è¡Œ 3 å€‹å·¥å…·èª¿ç”¨
2025-12-09 02:19:55 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89 200
2025-12-09 02:19:55 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism 200
2025-12-09 02:19:56 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=11&FORM=PERE 200
2025-12-09 02:19:56 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=11&FORM=PERE 200
2025-12-09 02:19:57 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=21&FORM=PERE1 200
2025-12-09 02:19:57 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=21&FORM=PERE1 200
2025-12-09 02:19:58 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=31&FORM=PERE2 200
2025-12-09 02:19:58 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=31&FORM=PERE2 200
2025-12-09 02:19:59 - primp - INFO - response: https://www.bing.com/search?q=site%3Aicd.who.int%2Fct11%2Ficd11_mms%2Fzh+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89&first=41&FORM=PERE3 200
2025-12-09 02:19:59 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E8%84%BE%E8%99%9B%E8%AD%89%EF%BC%88%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%EF%BC%89+mechanism&first=41&FORM=PERE3 200
2025-12-09 02:19:59 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 3
  ç½®ä¿¡åº¦æå‡: +0.20
2025-12-09 02:19:59 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 3
  ç½®ä¿¡åº¦æå‡: +0.20
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.50
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 02:19:59 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: è„¾è™›è­‰ï¼ˆåˆæ­¥å‚¾å‘ï¼‰, è¦†è“‹åº¦: 0.60
2025-12-09 02:20:06 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 02:20:13 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± 1a6c47c8***
2025-12-09 02:20:13 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-021936-c128afc5] è€—æ™‚: 36.28s
2025-12-09 02:20:13 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 02:20:13 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 36.28s
2025-12-09 02:26:41 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:26:41 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:26:41 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:26:41 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:26:41 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:26:41 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:26:41 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:26:41 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:26:41 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:26:42 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:26:42 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:26:42 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:26:42 - s_cbr.backend.main - INFO - 
2025-12-09 02:26:42 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:26:42 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:26:42 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:26:43 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:26:43 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:26:43 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:26:43 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:26:44 - s_cbr.SCBR-API - INFO - ğŸ“¥ æ”¶åˆ°è¨ºæ–·è«‹æ±‚ [IP: 127.0.0.1]
2025-12-09 02:26:44 - s_cbr.SCBR-API - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:26:44 - s_cbr.SCBR-API - INFO -    Session ID: None
2025-12-09 02:26:44 - s_cbr.SCBREngine - INFO - ğŸŒ€ å•Ÿå‹•è¨ºæ–· [SCBR-20251209-022644-7604f7ba]
2025-12-09 02:26:44 - s_cbr.SCBREngine - INFO -    å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:26:44 - s_cbr.SCBREngine - INFO -    session_id: None
2025-12-09 02:26:44 - s_cbr.SCBREngine - INFO -    continue_spiral: False
2025-12-09 02:26:44 - s_cbr.DialogManager - INFO - ğŸ†• å‰µå»ºæœƒè©±: acd99022***
2025-12-09 02:26:44 - s_cbr.DialogManager - INFO -    åˆå§‹å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:26:44 - s_cbr.DialogManager - INFO -    ç•¶å‰æœƒè©±ç¸½æ•¸: 1
2025-12-09 02:26:44 - s_cbr.SCBREngine - INFO -    æœƒè©±ID: acd99022-2150-4197-8d8a-75a38586808e
2025-12-09 02:26:44 - s_cbr.SCBREngine - INFO -    ç•¶å‰è¼ªæ¬¡: 1
2025-12-09 02:26:44 - s_cbr.SCBREngine - INFO -    ç´¯ç©å•é¡Œ: é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›ï¼Œæœ‰é»å™å¿ƒæƒ³åï¼Œå¤§ä¾¿æ¯”è¼ƒç¨€ã€‚...
2025-12-09 02:26:44 - s_cbr.FourLayerPipeline - INFO - [L1] ä½¿ç”¨ Agentic NLU æ¨¡å¼
2025-12-09 02:26:53 - s_cbr.LLMClient - WARNING - âš ï¸ è¼¸å‡ºéæ¿¾ï¼šæª¢æ¸¬åˆ° 1 è™•æ•æ„Ÿè³‡è¨Š
2025-12-09 02:26:53 - s_cbr.FourLayerPipeline - INFO - [L1 FINAL RESULT] L1 ç‹€æ…‹: ok
2025-12-09 02:26:53 - s_cbr.FourLayerPipeline - INFO - [L1 AGENTIC DECISION]
  Overall Confidence: 0.650
  Decided Alpha: 0.6
  Strategy Type: balanced
  Expected Quality: medium
2025-12-09 02:26:53 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL] ä½¿ç”¨ Agentic æ™ºèƒ½æª¢ç´¢
2025-12-09 02:26:53 - AgenticRetrieval - INFO - [AgenticRetrieval] é–‹å§‹æ™ºèƒ½æª¢ç´¢ - Alpha: 0.6, ç­–ç•¥: balanced, é æœŸå“è³ª: medium
2025-12-09 02:26:53 - AgenticRetrieval - INFO - [AgenticRetrieval] åŸ·è¡Œæª¢ç´¢ #1 - Alpha: 0.60
2025-12-09 02:26:54 - AgenticRetrieval - INFO - [AgenticRetrieval] å‘é‡ç”ŸæˆæˆåŠŸ - ç¶­åº¦: 1024
2025-12-09 02:26:54 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å•Ÿå‹• - Index: TCMCase, Alpha: 0.60, å‘é‡: æ˜¯, Limit: 3
2025-12-09 02:26:54 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.60, æŸ¥è©¢å­—ä¸²é•·åº¦=34 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœï¼Œæ„Ÿè¦ºè„¹è„¹çš„ï¼ŒæŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 02:26:54 - s_cbr.SearchEngine - INFO - ğŸ” TCMCase HYBRID Î±=0.6, qdim=1024, fields=['full_text'], props=['created_at', 'updated_at', 'pulse_terms', 'diagnosis', 'symptom_terms', 'treatment_terms', 'age', 'zangfu_terms', 'gender', 'raw_data', 'visit_date', 'case_id', 'suggestion', 'jieba_tokens', 'tongue_terms', 'full_text', 'chief_complaint', 'patient_id', 'treatment_principle', 'syndrome_terms']
2025-12-09 02:26:54 - s_cbr.SearchEngine - INFO - ğŸ“Š TCMCase æœç´¢: 3 å€‹çµæœ
2025-12-09 02:26:54 - s_cbr.SearchEngine - INFO - [SearchEngine] æ™ºèƒ½æª¢ç´¢å®Œæˆ - è¿”å› 3 å€‹çµæœ
2025-12-09 02:26:54 - AgenticRetrieval - INFO - [AgenticRetrieval] æª¢ç´¢å®Œæˆ - æ‰¾åˆ° 3 å€‹æ¡ˆä¾‹, å“è³ª: 0.716
2025-12-09 02:26:54 - AgenticRetrieval - INFO - [AgenticRetrieval] âœ… æª¢ç´¢æˆåŠŸ (å“è³ª: 0.716)
2025-12-09 02:26:54 - s_cbr.FourLayerPipeline - INFO - [AGENTIC RETRIEVAL]
  åˆå§‹ Alpha: 0.60
  æœ€çµ‚ Alpha: 0.60
  å˜—è©¦æ¬¡æ•¸: 1
  å“è³ªè©•åˆ†: 0.716
  Fallback: å¦
2025-12-09 02:26:54 - s_cbr.FourLayerPipeline - INFO - [RETRIEVAL RESULT] æˆåŠŸæ‰¾åˆ° 3 å€‹æ¡ˆä¾‹. Top 3 ç¯„ä¾‹: [{'case_id': 'CASE_20251005211408_M508_dfea1255', 'score': '0.6000'}, {'case_id': 'CASE_20251005212325_M456_ea0fddb3', 'score': '0.5904'}, {'case_id': 'CASE_20251005211456_V993_ae529307', 'score': '0.5783'}]
2025-12-09 02:27:01 - s_cbr.FourLayerPipeline - INFO - [L2] ä½¿ç”¨ Agentic å¢å¼·æ¨¡å¼
2025-12-09 02:27:01 - L2AgenticDiagnosis - INFO - [L2Agentic] ä½¿ç”¨ enhance_diagnosis é©é…æ–¹æ³•
2025-12-09 02:27:01 - L2AgenticDiagnosis - INFO - [L2Agentic] è©•ä¼°çµæœ
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 02:27:02 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«æŸ¥è©¢: 'é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœ æ„Ÿè¦ºè„¹è„¹çš„ æŒ‰ä¸‹å»æ›´ç—›...' (Alpha=0.2, æ’é™¤=[])
2025-12-09 02:27:02 - s_cbr.SearchEngine - INFO - ğŸ” TCM å•Ÿå‹•æª¢ç´¢: Mode=HYBRID, Î±=0.20, æŸ¥è©¢å­—ä¸²é•·åº¦=33 (é€™å¹¾å¤©èƒƒå¾ˆä¸èˆ’æœ æ„Ÿè¦ºè„¹è„¹çš„ æŒ‰ä¸‹å»æ›´ç—›...)
2025-12-09 02:27:02 - s_cbr.SearchEngine - INFO - ğŸ” TCM HYBRID Î±=0.2, qdim=1024, fields=['name_zh', 'definition', 'clinical_manifestations', 'vector_text'], props=['subcategory', 'vector_text', 'name_en', 'clinical_manifestations', 'name_zh', 'tcm_id', 'category', 'definition', 'associated_western_diseases', 'gbt_code']
2025-12-09 02:27:02 - s_cbr.SearchEngine - INFO - ğŸ“Š TCM æœç´¢: 10 å€‹çµæœ
2025-12-09 02:27:02 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨æª¢ç´¢å€™é¸: ['æ¿•ç†±è…°ç—›è­‰', 'è…æ°£ä¸è¶³è­‰ (éºå°¿/äº”é²)', 'æ¿•ç†±è…°ç—›è­‰', 'å¯’æ¿•è…°ç—›è­‰', 'å¿ƒæ°£è™›å¼±è­‰ (æ±—è­‰)', 'å¯’æ¿•è…°ç—›è­‰', 'ç‰¹ç¨Ÿè³ª (Iå‹)', 'è‚ç«ä¸Šç‚è­‰ (å¤©è¡Œèµ¤çœ¼)', 'è‘—ç—º (æ¿•ç—º)', 'ç—°æ¿•é˜»è‚ºè­‰ (ç¡çœ å‘¼å¸ä¸­æ­¢)']
2025-12-09 02:27:02 - L2AgenticDiagnosis - INFO - [L2Agentic] å…§éƒ¨çŸ¥è­˜åº«ç„¡åŒ¹é… (Top: æ¿•ç†±è…°ç—›è­‰ - å·²è¢«éæ¿¾)
2025-12-09 02:27:02 - L2AgenticDiagnosis - INFO - [L2Agentic] è§¸ç™¼ Tool C (ç½®ä¿¡åº¦ä¸è¶³: 0.68)
2025-12-09 02:27:02 - L2AgenticDiagnosis - INFO - [L2Agentic] ä¸¦è¡ŒåŸ·è¡Œ 1 å€‹å·¥å…·èª¿ç”¨
2025-12-09 02:27:02 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E6%B3%84%E7%80%89%EF%BC%88%E8%84%BE%E8%99%9B%EF%BC%89%28%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%29+mechanism 200
2025-12-09 02:27:03 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E6%B3%84%E7%80%89%EF%BC%88%E8%84%BE%E8%99%9B%EF%BC%89%28%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%29+mechanism&first=11&FORM=PERE 200
2025-12-09 02:27:04 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E6%B3%84%E7%80%89%EF%BC%88%E8%84%BE%E8%99%9B%EF%BC%89%28%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%29+mechanism&first=21&FORM=PERE1 200
2025-12-09 02:27:05 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E6%B3%84%E7%80%89%EF%BC%88%E8%84%BE%E8%99%9B%EF%BC%89%28%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%29+mechanism&first=31&FORM=PERE2 200
2025-12-09 02:27:06 - primp - INFO - response: https://www.bing.com/search?q=%28site%3Atcmip.cn+OR+site%3Ancbi.nlm.nih.gov%29+%E6%B3%84%E7%80%89%EF%BC%88%E8%84%BE%E8%99%9B%EF%BC%89%28%E5%88%9D%E6%AD%A5%E5%82%BE%E5%90%91%29+mechanism&first=41&FORM=PERE3 200
2025-12-09 02:27:06 - L2AgenticDiagnosis - INFO - [L2Agentic] å¢å¼·å®Œæˆ
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.05
2025-12-09 02:27:06 - s_cbr.FourLayerPipeline - INFO - [L2 AGENTIC ENHANCEMENT]
  é©—è­‰ç‹€æ…‹: validated
  å·¥å…·èª¿ç”¨æ•¸: 1
  ç½®ä¿¡åº¦æå‡: +0.05
  æ¡ˆä¾‹å®Œæ•´åº¦: 0.70
  è¨ºæ–·ç½®ä¿¡åº¦: 0.68
2025-12-09 02:27:06 - s_cbr.FourLayerPipeline - INFO - [L2 DIAGNOSIS SUMMARY] éŒ¨å®š ID: CASE_20251005212325_M456_ea0fddb3, è­‰å‹: æ³„ç€‰ï¼ˆè„¾è™›ï¼‰(åˆæ­¥å‚¾å‘), è¦†è“‹åº¦: 0.60
2025-12-09 02:27:12 - s_cbr.FourLayerPipeline - INFO - [L3 REVIEW STATUS] å¯©æ ¸çµæœ: rewritten
2025-12-09 02:27:19 - s_cbr.DialogManager - INFO - ğŸ“Š è¨˜éŒ„ç¬¬ 1 è¼ªçµæœåˆ°æœƒè©± acd99022***
2025-12-09 02:27:19 - s_cbr.SCBREngine - INFO - âœ… è¨ºæ–·å®Œæˆ [SCBR-20251209-022644-7604f7ba] è€—æ™‚: 35.65s
2025-12-09 02:27:19 - s_cbr.SCBREngine - INFO -    è¼ªæ¬¡: 1, å¯ç¹¼çºŒ: True
2025-12-09 02:27:19 - s_cbr.SCBR-API - INFO - âœ… è¨ºæ–·å®Œæˆ [IP: 127.0.0.1] è€—æ™‚: 35.65s
2025-12-09 02:35:51 - s_cbr.RateLimiter - INFO - âœ… RateLimiter åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… RateLimiter åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… OWASPæ˜ å°„å™¨åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… å®‰å…¨æ¨¡çµ„åˆå§‹åŒ–å®Œæˆ
2025-12-09 02:35:51 - s_cbr.DialogManager - INFO - âœ… å°è©±ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ (max_sessions=100)
2025-12-09 02:35:51 - s_cbr.LLMClient - INFO - âœ… LLMå®¢æˆ¶ç«¯åˆå§‹åŒ–: model=meta/llama-3.3-70b-instruct, max_tokens=4000, timeout=30.0s
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… LLM å®¢æˆ¶ç«¯åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… EmbedClient åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:35:51 - s_cbr.SearchEngine - INFO - [SearchEngine] Connected to Weaviate
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… SearchEngine åˆå§‹åŒ–æˆåŠŸ
2025-12-09 02:35:51 - AgenticRetrieval - INFO - [AgenticRetrieval] åˆå§‹åŒ–å®Œæˆ - å“è³ªé–€æª»: 0.65, æœ€å¤§ fallback: 3
2025-12-09 02:35:51 - s_cbr.FourLayerPipeline - INFO - [FourLayerPipeline] TCMTools å·¥å…·åº«å·²æ›è¼‰
2025-12-09 02:35:51 - L2AgenticDiagnosis - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ - å·¥å…·èª¿ç”¨å·²å•Ÿç”¨
2025-12-09 02:35:51 - s_cbr.FourLayerPipeline - INFO - [L2Agentic] åˆå§‹åŒ–å®Œæˆ (å«å…§éƒ¨çŸ¥è­˜åº«é€£ç·š)
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… å››å±¤ SCBR ç®¡ç·šåˆå§‹åŒ–å®Œæˆ
2025-12-09 02:35:51 - s_cbr.SCBREngine - INFO - âœ… S-CBR Engine åˆå§‹åŒ–å®Œæˆ (å«å®‰å…¨é˜²è­·)
2025-12-09 02:35:52 - s_cbr.backend.main - INFO - ğŸš€ TCM S-CBR Backend v2.2 å•Ÿå‹•
2025-12-09 02:35:52 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:35:52 - s_cbr.backend.main - INFO - ğŸ“¦ å·²è¼‰å…¥æ¨¡çµ„:
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    âœ… S-CBR èºæ—‹æ¨ç†å¼•æ“
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    âœ… ANC ç—…ä¾‹ç®¡ç†ç³»çµ±
2025-12-09 02:35:52 - s_cbr.backend.main - INFO - 
2025-12-09 02:35:52 - s_cbr.backend.main - INFO - ğŸ”— å¯ç”¨ç«¯é»:
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    - èºæ—‹æ¨ç†: /api/scbr/v2/*
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    - ç—…ä¾‹ä¿å­˜: POST /api/case/save
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æŸ¥è©¢: GET /api/case/get/{case_id}
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    - ç—…ä¾‹æœç´¢: POST /api/case/search
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    - ç—…ä¾‹çµ±è¨ˆ: GET /api/case/stats
2025-12-09 02:35:52 - s_cbr.backend.main - INFO -    - å¥åº·æª¢æŸ¥: GET /healthz
2025-12-09 02:35:52 - s_cbr.backend.main - INFO - ============================================================
2025-12-09 02:35:53 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/meta "HTTP/1.1 200 OK"
2025-12-09 02:35:54 - httpx - INFO - HTTP Request: GET https://pypi.org/pypi/weaviate-client/json "HTTP/1.1 200 OK"
2025-12-09 02:35:54 - httpx - INFO - HTTP Request: GET http://localhost:8080/v1/schema/TCMCase "HTTP/1.1 200 OK"
2025-12-09 02:35:54 - s_cbr.backend.main - INFO - âœ… ANC ç—…ä¾‹è™•ç†å™¨åˆå§‹åŒ–æˆåŠŸ
